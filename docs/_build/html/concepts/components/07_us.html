

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>User simulator &mdash; Comet v1.2.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/modify.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/logo.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Reinforcement Learning" href="../Reinforcement_learning.html" />
    <link rel="prev" title="Natural language generator(NLG)" href="06_nlg.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro/introduction.html">An introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/motivation.html">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/motivation.html#scope">Scope</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/motivation.html#task-oriented-dialog-systems">Task-oriented dialog systems</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/play_around.html">Play Around</a></li>
</ul>
<p class="caption"><span class="caption-text">Step By Step Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../step_by_step/00_overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../step_by_step/01_define_the_hierarchy.html">Step 1: Define domain, ontology, database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../step_by_step/02_custom_the_dialogue_state.html">Step 2: Custom the Dialogue State (Optional)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../step_by_step/03_custom_the_state_featurizer.html">Step 3: Custom the State Featurizer (Optional)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../step_by_step/04_custom_dialogue_state_tracker.html">Step 4: Custom the Dialogue State Tracker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../step_by_step/05_define_a_hancraft_policy.html">Step 5: Build a Warm-up Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../step_by_step/06_build_natatural_language_template.html">Step 6: Build a Natural Language Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../step_by_step/07_build_user_simulator.html">Step 7: Build the User Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../step_by_step/08_connect_all_components_by_config.html">Step 8: Connect all components by Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../step_by_step/09_generate_training_data.html">Step 9: Prepare Training Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../step_by_step/10_deploy_and_train_models.html">Step 10: Train and deploy models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../step_by_step/Summarize.html">Summarize</a></li>
</ul>
<p class="caption"><span class="caption-text">Concepts</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../domain.html">Domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../domain.html#ontology">Ontology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../domain.html#database">Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trainning_data/index.html">Training Data Format</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Comet’s components!</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_dialogue_manager.html">Dialogue manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_dst.html">Dialogue state tracker</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_policy.html">Policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_dialogue_state.html">Dialogue State</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_nlu.html">Natural language understanding(NLU)</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_nlg.html">Natural language generator(NLG)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">User simulator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-is-the-goal">What is the Goal?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#agenda-based-user-simulator">Agenda-Based User Simulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#user-goal">User Goal</a></li>
<li class="toctree-l3"><a class="reference internal" href="#user-agenda-mode">User Agenda Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#frame-level-interaction">Frame-Level Interaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#natural-language-level-interaction">Natural Language Level Interaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#error-model">Error Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reward-function">Reward Function</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Reinforcement_learning.html">Reinforcement Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chanel_connector.html">Channel Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Architecture.html">Architecture</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../comet/comet.html">comet package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Comet</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Comet’s components!</a> &raquo;</li>
        
      <li>User simulator</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/concepts/components/07_us.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="user-simulator">
<span id="id1"></span><h1>User simulator<a class="headerlink" href="#user-simulator" title="Permalink to this headline">¶</a></h1>
<img alt="../../_images/dialogue_flow_us1.png" src="../../_images/dialogue_flow_us1.png" />
<p>User simulators are used to simulate an actual user so that an agent can be trained much faster than
if real users were forced to sit down and give it multiple hours of training. User simulator research
for chatbot domains is a hot research topic.</p>
<p>The one covered in our platform is the very well known Agenda-Based User Simulator, This means
that a user has a goal for that episode and it takes actions in accordance to this goal while keeping
track of an internal state that allows it follow the dialogue to take informed actions.</p>
<div class="section" id="what-is-the-goal">
<h2>What is the Goal?<a class="headerlink" href="#what-is-the-goal" title="Permalink to this headline">¶</a></h2>
<p>User goals are sampled from a corpus of real dialogue or hand-crafted (or both). Each goal is made up
of inform slots and request slots just like an action but without the intent. There are a couple standard
ways to grab the goals from a corpus</p>
<ul class="simple">
<li><p>All of the slots (request and inform) from the initial user action in an episode make a single goal</p></li>
<li><p>All slots from all user actions in an episode are combined to make a single goal</p></li>
</ul>
<p>A few examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;request_slots&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;UNK&#39;</span><span class="p">,</span> <span class="s1">&#39;theater&#39;</span><span class="p">:</span> <span class="s1">&#39;UNK&#39;</span><span class="p">},</span> <span class="s1">&#39;inform_slots&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;numberofpeople&#39;</span><span class="p">:</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;moviename&#39;</span><span class="p">:</span> <span class="s1">&#39;zootopia&#39;</span><span class="p">,</span> <span class="s1">&#39;starttime&#39;</span><span class="p">:</span> <span class="s1">&#39;matinee&#39;</span><span class="p">}}</span>
<span class="p">{</span><span class="s1">&#39;request_slots&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;theater&#39;</span><span class="p">:</span> <span class="s1">&#39;UNK&#39;</span><span class="p">},</span> <span class="s1">&#39;inform_slots&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="s1">&#39;la&#39;</span><span class="p">,</span> <span class="s1">&#39;numberofpeople&#39;</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;distanceconstraints&#39;</span><span class="p">:</span> <span class="s1">&#39;downtown&#39;</span><span class="p">,</span> <span class="s1">&#39;video_format&#39;</span><span class="p">:</span> <span class="s1">&#39;3d&#39;</span><span class="p">,</span> <span class="s1">&#39;starttime&#39;</span><span class="p">:</span> <span class="s1">&#39;7pm&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;tomorrow&#39;</span><span class="p">,</span> <span class="s1">&#39;moviename&#39;</span><span class="p">:</span> <span class="s1">&#39;creed&#39;</span><span class="p">}}</span>
</pre></div>
</div>
</div>
<div class="section" id="agenda-based-user-simulator">
<h2>Agenda-Based User Simulator<a class="headerlink" href="#agenda-based-user-simulator" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<img alt="../../_images/us1.png" src="../../_images/us1.png" />
</div>
<p>The Agenda-Based User Simulator was proposed by Schatzmann and is explained in detail in this <a class="reference external" href="https://www.semanticscholar.org/paper/Statistical-User-Simulation-with-a-Hidden-Agenda-Schatzmann-Thomson/fdde1f5ee1734e562298d6d4ca6893921276f0d2">paper</a>.
Conceptually, the simulator maintains an “agenda” of things to say, which is usually implemented as
a stack. When the simulator receives input, it consults its policy (or its set of rules) to see what
content to push into the agenda, as a response to the input. After some housekeeping (e.g. removing
duplicates or content that is no longer valid), the simulator will pop one or more items off the
agenda that will be used to formulate its response.</p>
<p>The Agenda-Based User Simulator also has an error simulation module, that can simulate speech
recognition / language understanding errors. Based on some probabilities, it will distort the output
dialogue acts of the simulator - the intent, slot, or value (different probability for each).</p>
<p>Now we will dive into each element of a User simulator</p>
</div>
<div class="section" id="user-goal">
<h2>User Goal<a class="headerlink" href="#user-goal" title="Permalink to this headline">¶</a></h2>
<p>Sampled from a real corpus / hand-crafted list</p>
<ul>
<li><dl>
<dt>Information access</dt><dd><ul class="simple">
<li><p>Inflexible: the user has specific entries for search</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>request_slot: rating, inform_slots: {moviename=“A”, …}
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Task completion</dt><dd><ul class="simple">
<li><p>Inflexible: the user has specific rows for search</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>request_ticket, inform_slots: {moviename=“A”, …}
</pre></div>
</div>
<ul class="simple">
<li><p>Flexible: some slot values are unknown or can be suggested</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>request_ticket, request_slots: {time, theater},
inform_slots: {moviename=“A”, …}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="user-agenda-mode">
<h2>User Agenda Mode<a class="headerlink" href="#user-agenda-mode" title="Permalink to this headline">¶</a></h2>
<p>User agenda defines how a user interacts with the system in the dialogue level</p>
<ul class="simple">
<li><p>Random order: random sample a slot for informing or request</p></li>
<li><p>Fixed order: define a list of ordering slots for informing or request</p></li>
</ul>
</div>
<div class="section" id="frame-level-interaction">
<h2>Frame-Level Interaction<a class="headerlink" href="#frame-level-interaction" title="Permalink to this headline">¶</a></h2>
<p>DM receives frame-level information</p>
<ul class="simple">
<li><p>No error model: perfect recognizer and LU</p></li>
<li><p>Error model: simulate the possible errors</p></li>
</ul>
<div class="figure align-center">
<img alt="../../_images/frame_mode1.png" src="../../_images/frame_mode1.png" />
</div>
</div>
<div class="section" id="natural-language-level-interaction">
<h2>Natural Language Level Interaction<a class="headerlink" href="#natural-language-level-interaction" title="Permalink to this headline">¶</a></h2>
<p>User simulator sends natural language</p>
<ul class="simple">
<li><p>No recognition error</p></li>
<li><p>Errors from NLG or LU</p></li>
</ul>
<div class="figure align-center">
<img alt="../../_images/nlg_level1.png" src="../../_images/nlg_level1.png" />
</div>
</div>
<div class="section" id="error-model">
<h2>Error Model<a class="headerlink" href="#error-model" title="Permalink to this headline">¶</a></h2>
<p>There are several for error model</p>
<ul class="simple">
<li><dl class="simple">
<dt>Handcraft: Randomly generate errors by</dt><dd><ul>
<li><p>Replacing with an incorrect intent</p></li>
<li><p>Deleting an informable slot</p></li>
<li><p>Replacing with an incorrect slot (value is original)</p></li>
<li><p>Replacing with an incorrect slot value</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Model-based</dt><dd><ul>
<li><p>Simulate the errors based on the ASR or LU confusion</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="reward-function">
<h2>Reward Function<a class="headerlink" href="#reward-function" title="Permalink to this headline">¶</a></h2>
<p>It’s Success measurement. Check whether the returned results satisfy the
predefined user goal.</p>
<ul class="simple">
<li><p>Success: large positive reward</p></li>
<li><p>Fail: large negative reward</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Reinforcement_learning.html" class="btn btn-neutral float-right" title="Reinforcement Learning" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="06_nlg.html" class="btn btn-neutral float-left" title="Natural language generator(NLG)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, NLP Team, Ftech.AI

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>